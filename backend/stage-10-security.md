# –≠—Ç–∞–ø 10: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞ (Security)

> **–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
> 
> **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —ç—Ç–∞–ø—ã ‚úÖ
> 
> **–°–µ—Ä–≤–µ—Ä:** http://localhost:3001/api
> 
> **Swagger:** http://localhost:3001/api/docs

---

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∑–∞—â–∏—Ç—É API: HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Helmet), –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (Rate Limiting), CORS, –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—é, –∑–∞—â–∏—Ç—É –æ—Ç SQL injection, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.

---

## üìö –ì–ª–æ—Å—Å–∞—Ä–∏–π (–¥–ª—è frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

### üõ°Ô∏è Helmet

**Helmet** ‚Äî middleware –¥–ª—è Express/NestJS, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≤–µ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (XSS, clickjacking, sniffing –∏ –¥—Ä.).

### ‚è±Ô∏è Rate Limiting (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)

**Rate Limiting** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã –æ—Ç DDoS-–∞—Ç–∞–∫ –∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏.

### üåê CORS (Cross-Origin Resource Sharing)

**CORS** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å, –∫–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã –º–æ–≥—É—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API. –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–æ–≤.

### ‚úÖ Validation Pipe

**Validation Pipe** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º NestJS –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ class-validator.

### üßπ Sanitization (–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è)

**Sanitization** ‚Äî –æ—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ (HTML-—Ç–µ–≥–∏, —Å–∫—Ä–∏–ø—Ç—ã –∏ —Ç.–¥.).

### üîí SQL Injection Protection

**SQL Injection** ‚Äî —Ç–∏–ø –∞—Ç–∞–∫–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–Ω–µ–¥—Ä—è–µ—Ç SQL-–∫–æ–¥ —á–µ—Ä–µ–∑ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. TypeORM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —ç—Ç–æ–≥–æ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

### üìù Request Logging (–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)

**Request Logging** ‚Äî –∑–∞–ø–∏—Å—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –æ—Ç–ª–∞–¥–∫–∏ –∏ –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### ‚ö†Ô∏è Exception Filter (–§–∏–ª—å—Ç—Ä –∏—Å–∫–ª—é—á–µ–Ω–∏–π)

**Exception Filter** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/src/
‚îú‚îÄ‚îÄ main.ts                              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ middleware)
‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îú‚îÄ‚îÄ filters/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts                     # –≠–∫—Å–ø–æ—Ä—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ http-exception.filter.ts     # –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –∏—Å–∫–ª—é—á–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ interceptors/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts                     # –≠–∫—Å–ø–æ—Ä—Ç interceptors
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logging.interceptor.ts       # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (–Ω–æ–≤—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ middleware/
‚îÇ       ‚îú‚îÄ‚îÄ index.ts                     # –≠–∫—Å–ø–æ—Ä—Ç middleware
‚îÇ       ‚îî‚îÄ‚îÄ rate-limit.middleware.ts     # Rate limiting (–Ω–æ–≤—ã–π)
‚îî‚îÄ‚îÄ config/
    ‚îî‚îÄ‚îÄ configuration.ts                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (rate limits)
```

---

## üîê –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. Helmet ‚Äî HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Helmet —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:

| –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| `X-Content-Type-Options: nosniff` | –ó–∞–ø—Ä–µ—â–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É —É–≥–∞–¥—ã–≤–∞—Ç—å MIME-—Ç–∏–ø |
| `X-Frame-Options: DENY` | –ó–∞—â–∏—Ç–∞ –æ—Ç clickjacking |
| `X-XSS-Protection: 1; mode=block` | –í–∫–ª—é—á–∞–µ—Ç XSS-—Ñ–∏–ª—å—Ç—Ä –±—Ä–∞—É–∑–µ—Ä–∞ |
| `Strict-Transport-Security` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS |
| `Content-Security-Policy` | –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ |
| `X-DNS-Prefetch-Control: off` | –û—Ç–∫–ª—é—á–∞–µ—Ç DNS prefetching |
| `X-Download-Options: noopen` | –ó–∞–ø—Ä–µ—â–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `X-Permitted-Cross-Domain-Policies: none` | –ó–∞–ø—Ä–µ—â–∞–µ—Ç Flash/PDF cross-domain |

---

### 2. Rate Limiting ‚Äî –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

–†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ endpoints:

| Endpoint | –û–∫–Ω–æ | –õ–∏–º–∏—Ç | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|------|-------|---------|
| –û–±—â–∏–π (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã) | 15 –º–∏–Ω—É—Ç | 100 –∑–∞–ø—Ä–æ—Å–æ–≤ | –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS |
| Auth (`/api/auth/*`) | 1 —á–∞—Å | 10 –ø–æ–ø—ã—Ç–æ–∫ | –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ |
| Upload (`/api/upload/*`) | 1 —á–∞—Å | 50 –∑–∞–≥—Ä—É–∑–æ–∫ | –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —Ñ–∞–π–ª–∞–º–∏ |

---

### 3. CORS ‚Äî –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ CORS:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `origin` | `http://localhost:3000` | –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–π –¥–æ–º–µ–Ω frontend |
| `credentials` | `true` | –†–∞–∑—Ä–µ—à–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É cookies |
| `methods` | `GET, POST, PUT, DELETE, PATCH, OPTIONS` | –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã |
| `allowedHeaders` | `Content-Type, Authorization` | –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ |

---

### 4. Validation Pipe ‚Äî –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ì–ª–æ–±–∞–ª—å–Ω—ã–π ValidationPipe —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

| –û–ø—Ü–∏—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `whitelist` | `true` | –£–¥–∞–ª—è–µ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏–∑ DTO |
| `forbidNonWhitelisted` | `true` | –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö |
| `transform` | `true` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ |
| `transformOptions.enableImplicitConversion` | `true` | –ù–µ—è–≤–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ |

---

### 5. Exception Filter ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```json
{
  "statusCode": 400,
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/endpoint"
}
```

---

### 6. Logging Interceptor ‚Äî –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ:

```
[Nest] LOG [HTTP] GET /api/images - 200 - 45ms
[Nest] LOG [HTTP] POST /api/auth/login - 401 - 12ms
```

---

## üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
# –£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –≠—Ç–∞–ø–µ 1
npm install helmet express-rate-limit

# –¢–∏–ø—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
npm install -D @types/express-rate-limit
```

---

### configuration.ts (–æ–±–Ω–æ–≤–∏—Ç—å)

```typescript
// src/config/configuration.ts
export default () => ({
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ...

  // Rate Limiting
  rateLimit: {
    // –û–±—â–∏–π –ª–∏–º–∏—Ç
    general: {
      windowMs: parseInt(process.env.RATE_LIMIT_WINDOW, 10) || 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
      max: parseInt(process.env.RATE_LIMIT_MAX, 10) || 100, // 100 –∑–∞–ø—Ä–æ—Å–æ–≤
    },
    // –õ–∏–º–∏—Ç –¥–ª—è auth endpoints
    auth: {
      windowMs: parseInt(process.env.RATE_LIMIT_AUTH_WINDOW, 10) || 60 * 60 * 1000, // 1 —á–∞—Å
      max: parseInt(process.env.RATE_LIMIT_AUTH_MAX, 10) || 10, // 10 –ø–æ–ø—ã—Ç–æ–∫
    },
    // –õ–∏–º–∏—Ç –¥–ª—è upload endpoints
    upload: {
      windowMs: parseInt(process.env.RATE_LIMIT_UPLOAD_WINDOW, 10) || 60 * 60 * 1000, // 1 —á–∞—Å
      max: parseInt(process.env.RATE_LIMIT_UPLOAD_MAX, 10) || 50, // 50 –∑–∞–≥—Ä—É–∑–æ–∫
    },
  },
});
```

---

### .env (–¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)

```env
# Rate Limiting
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=100
RATE_LIMIT_AUTH_WINDOW=3600000
RATE_LIMIT_AUTH_MAX=10
RATE_LIMIT_UPLOAD_WINDOW=3600000
RATE_LIMIT_UPLOAD_MAX=50
```

---

### logging.interceptor.ts (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)

```typescript
// src/common/interceptors/logging.interceptor.ts
import {
  Injectable,
  NestInterceptor,
  ExecutionContext,
  CallHandler,
  Logger,
} from '@nestjs/common';
import { Observable } from 'rxjs';
import { tap } from 'rxjs/operators';
import { Request, Response } from 'express';

/**
 * Interceptor –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
 * 
 * –õ–æ–≥–∏—Ä—É–µ—Ç:
 * - HTTP –º–µ—Ç–æ–¥
 * - URL
 * - –°—Ç–∞—Ç—É—Å –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞
 * - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
 * - IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
 * - User Agent
 */
@Injectable()
export class LoggingInterceptor implements NestInterceptor {
  private readonly logger = new Logger('HTTP');

  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {
    const ctx = context.switchToHttp();
    const request = ctx.getRequest<Request>();
    const response = ctx.getResponse<Response>();

    const { method, url, ip } = request;
    const userAgent = request.get('user-agent') || '';
    const startTime = Date.now();

    return next.handle().pipe(
      tap({
        next: () => {
          const duration = Date.now() - startTime;
          const statusCode = response.statusCode;

          this.logger.log(
            `${method} ${url} - ${statusCode} - ${duration}ms - ${ip} - ${userAgent}`,
          );
        },
        error: (error) => {
          const duration = Date.now() - startTime;
          const statusCode = error.status || 500;

          this.logger.error(
            `${method} ${url} - ${statusCode} - ${duration}ms - ${ip} - ${userAgent}`,
          );
        },
      }),
    );
  }
}
```

---

### interceptors/index.ts (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)

```typescript
// src/common/interceptors/index.ts
export * from './logging.interceptor';
```

---

### http-exception.filter.ts (–æ–±–Ω–æ–≤–∏—Ç—å)

```typescript
// src/common/filters/http-exception.filter.ts
import {
  ExceptionFilter,
  Catch,
  ArgumentsHost,
  HttpException,
  HttpStatus,
  Logger,
} from '@nestjs/common';
import { Request, Response } from 'express';

/**
 * –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –∏—Å–∫–ª—é—á–µ–Ω–∏–π
 * 
 * –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞.
 * –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏.
 */
@Catch()
export class HttpExceptionFilter implements ExceptionFilter {
  private readonly logger = new Logger(HttpExceptionFilter.name);

  catch(exception: unknown, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse<Response>();
    const request = ctx.getRequest<Request>();

    let status = HttpStatus.INTERNAL_SERVER_ERROR;
    let message: string | string[] = 'Internal server error';
    let error = 'Internal Server Error';

    if (exception instanceof HttpException) {
      status = exception.getStatus();
      const exceptionResponse = exception.getResponse();

      if (typeof exceptionResponse === 'string') {
        message = exceptionResponse;
      } else if (typeof exceptionResponse === 'object') {
        const responseObj = exceptionResponse as any;
        message = responseObj.message || exception.message;
        error = responseObj.error || this.getErrorName(status);
      }
    } else if (exception instanceof Error) {
      message = exception.message;
      
      // –õ–æ–≥–∏—Ä—É–µ–º stack trace –¥–ª—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
      this.logger.error(
        `Unexpected error: ${exception.message}`,
        exception.stack,
      );
    }

    // –õ–æ–≥–∏—Ä—É–µ–º –≤—Å–µ –æ—à–∏–±–∫–∏
    this.logger.error(
      `${request.method} ${request.url} - ${status} - ${JSON.stringify(message)}`,
    );

    // –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
    const responseBody = {
      statusCode: status,
      message,
      error,
      timestamp: new Date().toISOString(),
      path: request.url,
    };

    response.status(status).json(responseBody);
  }

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –æ—à–∏–±–∫–∏ –ø–æ —Å—Ç–∞—Ç—É—Å –∫–æ–¥—É
   */
  private getErrorName(status: number): string {
    const errorNames: Record<number, string> = {
      400: 'Bad Request',
      401: 'Unauthorized',
      403: 'Forbidden',
      404: 'Not Found',
      405: 'Method Not Allowed',
      409: 'Conflict',
      422: 'Unprocessable Entity',
      429: 'Too Many Requests',
      500: 'Internal Server Error',
      502: 'Bad Gateway',
      503: 'Service Unavailable',
    };

    return errorNames[status] || 'Error';
  }
}
```

---

### filters/index.ts

```typescript
// src/common/filters/index.ts
export * from './http-exception.filter';
```

---

### main.ts (–ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é)

```typescript
// src/main.ts
import { NestFactory } from '@nestjs/core';
import { NestExpressApplication } from '@nestjs/platform-express';
import { ValidationPipe, Logger } from '@nestjs/common';
import { ConfigService } from '@nestjs/config';
import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';
import cookieParser from 'cookie-parser';
import helmet from 'helmet';
import rateLimit from 'express-rate-limit';
import { join } from 'path';
import { AppModule } from './app.module';
import { HttpExceptionFilter } from './common/filters';
import { LoggingInterceptor } from './common/interceptors';

async function bootstrap() {
  const logger = new Logger('Bootstrap');
  const app = await NestFactory.create<NestExpressApplication>(AppModule);

  const configService = app.get(ConfigService);
  const port = configService.get<number>('port') || 3001;
  const apiPrefix = configService.get<string>('apiPrefix') || 'api';
  const corsOrigin = configService.get<string>('cors.origin') || 'http://localhost:3000';
  const nodeEnv = configService.get<string>('nodeEnv') || 'development';

  // ==================== GLOBAL PREFIX ====================
  app.setGlobalPrefix(apiPrefix);

  // ==================== SECURITY: HELMET ====================
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  app.use(
    helmet({
      crossOriginEmbedderPolicy: false, // –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
      contentSecurityPolicy: {
        directives: {
          defaultSrc: ["'self'"],
          styleSrc: ["'self'", "'unsafe-inline'"],
          imgSrc: ["'self'", 'data:', 'blob:', '*'],
          scriptSrc: ["'self'", "'unsafe-inline'", "'unsafe-eval'"], // –î–ª—è Swagger
        },
      },
    }),
  );

  // ==================== SECURITY: CORS ====================
  // –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ —Å –¥—Ä—É–≥–∏—Ö –¥–æ–º–µ–Ω–æ–≤
  app.enableCors({
    origin: corsOrigin,
    credentials: true,
    methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS'],
    allowedHeaders: ['Content-Type', 'Authorization'],
  });

  // ==================== SECURITY: RATE LIMITING ====================
  // –û–±—â–∏–π –ª–∏–º–∏—Ç –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  const generalRateLimit = configService.get('rateLimit.general');
  app.use(
    rateLimit({
      windowMs: generalRateLimit?.windowMs || 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
      max: generalRateLimit?.max || 100, // 100 –∑–∞–ø—Ä–æ—Å–æ–≤
      message: {
        statusCode: 429,
        message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.',
        error: 'Too Many Requests',
      },
      standardHeaders: true, // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç RateLimit-* –∑–∞–≥–æ–ª–æ–≤–∫–∏
      legacyHeaders: false, // –û—Ç–∫–ª—é—á–∞–µ—Ç X-RateLimit-* –∑–∞–≥–æ–ª–æ–≤–∫–∏
    }),
  );

  // –õ–∏–º–∏—Ç –¥–ª—è auth endpoints (–∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞)
  const authRateLimit = configService.get('rateLimit.auth');
  app.use(
    `/${apiPrefix}/auth`,
    rateLimit({
      windowMs: authRateLimit?.windowMs || 60 * 60 * 1000, // 1 —á–∞—Å
      max: authRateLimit?.max || 10, // 10 –ø–æ–ø—ã—Ç–æ–∫
      message: {
        statusCode: 429,
        message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ —á–∞—Å.',
        error: 'Too Many Requests',
      },
      standardHeaders: true,
      legacyHeaders: false,
    }),
  );

  // –õ–∏–º–∏—Ç –¥–ª—è upload endpoints (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞)
  const uploadRateLimit = configService.get('rateLimit.upload');
  app.use(
    `/${apiPrefix}/upload`,
    rateLimit({
      windowMs: uploadRateLimit?.windowMs || 60 * 60 * 1000, // 1 —á–∞—Å
      max: uploadRateLimit?.max || 50, // 50 –∑–∞–≥—Ä—É–∑–æ–∫
      message: {
        statusCode: 429,
        message: '–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–≥—Ä—É–∑–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ —á–∞—Å.',
        error: 'Too Many Requests',
      },
      standardHeaders: true,
      legacyHeaders: false,
    }),
  );

  // ==================== COOKIE PARSER ====================
  app.use(cookieParser());

  // ==================== VALIDATION PIPE ====================
  // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true, // –£–¥–∞–ª—è–µ—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
      forbidNonWhitelisted: true, // –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö
      transform: true, // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
      transformOptions: {
        enableImplicitConversion: true, // –ù–µ—è–≤–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
      },
      // –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
      exceptionFactory: (errors) => {
        const messages = errors.map((error) => {
          const constraints = error.constraints;
          return constraints ? Object.values(constraints).join(', ') : 'Validation error';
        });
        return new BadRequestException(messages);
      },
    }),
  );

  // ==================== GLOBAL FILTERS ====================
  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
  app.useGlobalFilters(new HttpExceptionFilter());

  // ==================== GLOBAL INTERCEPTORS ====================
  // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ç–æ–ª—å–∫–æ –≤ development)
  if (nodeEnv === 'development') {
    app.useGlobalInterceptors(new LoggingInterceptor());
  }

  // ==================== STATIC FILES ====================
  // –†–∞–∑–¥–∞—á–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
  app.useStaticAssets(join(__dirname, '..', 'uploads'), {
    prefix: '/uploads/',
  });

  // ==================== SWAGGER ====================
  // API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  const config = new DocumentBuilder()
    .setTitle('SnapBoard API')
    .setDescription('API –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è SnapBoard - –≤–∏–∑—É–∞–ª—å–Ω–æ–π –¥–æ—Å–∫–∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è')
    .setVersion('1.0')
    .addBearerAuth()
    .addCookieAuth('access_token')
    .addTag('Auth', '–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è')
    .addTag('Profile', '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
    .addTag('Boards', '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å–∫–∞–º–∏')
    .addTag('Images', '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏')
    .addTag('Upload', '–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤')
    .addTag('Favorites', '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ')
    .build();

  const document = SwaggerModule.createDocument(app, config);
  SwaggerModule.setup(`${apiPrefix}/docs`, app, document);

  // ==================== START SERVER ====================
  await app.listen(port);

  logger.log(`üöÄ Application is running on: http://localhost:${port}/${apiPrefix}`);
  logger.log(`üìö Swagger docs: http://localhost:${port}/${apiPrefix}/docs`);
  logger.log(`üìù Environment: ${nodeEnv}`);
  logger.log(`üîí CORS origin: ${corsOrigin}`);
  logger.log(`‚è±Ô∏è Rate limits: General ${generalRateLimit?.max || 100}/15min, Auth ${authRateLimit?.max || 10}/hour, Upload ${uploadRateLimit?.max || 50}/hour`);
}

bootstrap();
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –∏–º–ø–æ—Ä—Ç `BadRequestException` –∏–∑ `@nestjs/common` –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞.

---

## üîÑ –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –¶–ï–ü–û–ß–ö–ê –û–ë–†–ê–ë–û–¢–ö–ò –ó–ê–ü–†–û–°–ê                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  –í—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å                                                        ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 1. HELMET                                                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    X-Content-Type-Options, X-Frame-Options, CSP –∏ –¥—Ä.           ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 2. CORS                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Origin –∑–∞–≥–æ–ª–æ–≤–æ–∫                                   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îú‚îÄ‚îÄ Origin –Ω–µ —Ä–∞–∑—Ä–µ—à—ë–Ω ‚îÄ‚îÄ‚ñ∫ 403 Forbidden                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îî‚îÄ‚îÄ Origin —Ä–∞–∑—Ä–µ—à—ë–Ω ‚îÄ‚îÄ‚ñ∫ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å                           ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 3. RATE LIMITING                                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç IP                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îú‚îÄ‚îÄ –õ–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω ‚îÄ‚îÄ‚ñ∫ 429 Too Many Requests                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îî‚îÄ‚îÄ –õ–∏–º–∏—Ç –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω ‚îÄ‚îÄ‚ñ∫ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å                         ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 4. COOKIE PARSER                                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ü–∞—Ä—Å–∏—Ç cookies –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ò–∑–≤–ª–µ–∫–∞–µ—Ç access_token, refresh_token                        ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 5. LOGGING INTERCEPTOR                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ù–∞—á–∏–Ω–∞–µ—Ç –æ—Ç—Å—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è                           ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –õ–æ–≥–∏—Ä—É–µ—Ç: –º–µ—Ç–æ–¥, URL, IP, User-Agent                         ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 6. AUTH GUARD (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç JWT —Ç–æ–∫–µ–Ω                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îú‚îÄ‚îÄ –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚îÄ‚îÄ‚ñ∫ 401 Unauthorized                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îî‚îÄ‚îÄ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π ‚îÄ‚îÄ‚ñ∫ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å                            ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 7. VALIDATION PIPE                                              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (body, query, params)              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îú‚îÄ‚îÄ –î–∞–Ω–Ω—ã–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã ‚îÄ‚îÄ‚ñ∫ 400 Bad Request                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    ‚îî‚îÄ‚îÄ –î–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã ‚îÄ‚îÄ‚ñ∫ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å                            ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 8. CONTROLLER / SERVICE                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    TypeORM –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL injection                            ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 9. EXCEPTION FILTER (–ø—Ä–∏ –æ—à–∏–±–∫–µ)                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –æ–± –æ—à–∏–±–∫–µ                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ    –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É                                              ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ 10. LOGGING INTERCEPTOR (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     –õ–æ–≥–∏—Ä—É–µ—Ç: —Å—Ç–∞—Ç—É—Å –∫–æ–¥, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è                      ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ                                                                 ‚îÇ
‚îÇ       ‚ñº                                                                 ‚îÇ
‚îÇ  –û—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É                                                          ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ Rate Limiting ‚Äî –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    RATE LIMITING –ü–û –¢–ò–ü–ê–ú ENDPOINTS                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ –û–ë–©–ò–ô –õ–ò–ú–ò–¢ (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã)                                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –û–∫–Ω–æ: 15 –º–∏–Ω—É—Ç                                                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –õ–∏–º–∏—Ç: 100 –∑–∞–ø—Ä–æ—Å–æ–≤                                             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫: /api/*                                           ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–∏–º–µ—Ä:                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ó–∞–ø—Ä–æ—Å #1-100  ‚îÄ‚îÄ‚ñ∫ ‚úÖ OK                                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ó–∞–ø—Ä–æ—Å #101    ‚îÄ‚îÄ‚ñ∫ ‚ùå 429 Too Many Requests                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ (—á–µ—Ä–µ–∑ 15 –º–∏–Ω) ‚îÄ‚îÄ‚ñ∫ ‚úÖ –°—á—ë—Ç—á–∏–∫ —Å–±—Ä–æ—à–µ–Ω                           ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ AUTH –õ–ò–ú–ò–¢ (–∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞)                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –û–∫–Ω–æ: 1 —á–∞—Å                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –õ–∏–º–∏—Ç: 10 –ø–æ–ø—ã—Ç–æ–∫                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫: /api/auth/*                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ - POST /api/auth/login                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ - POST /api/auth/register                                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ - POST /api/auth/refresh                                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞:                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü–æ–ø—ã—Ç–∫–∞ #1-10  ‚îÄ‚îÄ‚ñ∫ ‚úÖ OK (–¥–∞–∂–µ –µ—Å–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π)            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü–æ–ø—ã—Ç–∫–∞ #11   ‚îÄ‚îÄ‚ñ∫ ‚ùå 429 "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞"          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ (—á–µ—Ä–µ–∑ 1 —á–∞—Å) ‚îÄ‚îÄ‚ñ∫ ‚úÖ –°—á—ë—Ç—á–∏–∫ —Å–±—Ä–æ—à–µ–Ω                            ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ UPLOAD –õ–ò–ú–ò–¢ (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —Ñ–∞–π–ª–∞–º–∏)                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –û–∫–Ω–æ: 1 —á–∞—Å                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –õ–∏–º–∏—Ç: 50 –∑–∞–≥—Ä—É–∑–æ–∫                                              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫: /api/upload/*                                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ - POST /api/upload/file                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ - POST /api/upload/url                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–∏–º–µ—Ä:                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ó–∞–≥—Ä—É–∑–∫–∞ #1-50 ‚îÄ‚îÄ‚ñ∫ ‚úÖ OK                                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ó–∞–≥—Ä—É–∑–∫–∞ #51   ‚îÄ‚îÄ‚ñ∫ ‚ùå 429 "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–≥—Ä—É–∑–æ–∫"             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ (—á–µ—Ä–µ–∑ 1 —á–∞—Å)  ‚îÄ‚îÄ‚ñ∫ ‚úÖ –°—á—ë—Ç—á–∏–∫ —Å–±—Ä–æ—à–µ–Ω                           ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection

TypeORM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL injection —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ó–ê–©–ò–¢–ê –û–¢ SQL INJECTION                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚ùå –û–ü–ê–°–ù–û (raw SQL):                                                   ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  const query = `SELECT * FROM users WHERE email = '${email}'`;          ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –ê—Ç–∞–∫–∞: email = "'; DROP TABLE users; --"                               ‚îÇ
‚îÇ  –†–µ–∑—É–ª—å—Ç–∞—Ç: SELECT * FROM users WHERE email = ''; DROP TABLE users; -- ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û (TypeORM):                                                ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ  // Repository –º–µ—Ç–æ–¥—ã                                                   ‚îÇ
‚îÇ  await this.usersRepository.findOne({ where: { email } });              ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  // QueryBuilder —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏                                          ‚îÇ
‚îÇ  await this.usersRepository                                             ‚îÇ
‚îÇ    .createQueryBuilder('user')                                          ‚îÇ
‚îÇ    .where('user.email = :email', { email })                             ‚îÇ
‚îÇ    .getOne();                                                           ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –ê—Ç–∞–∫–∞: email = "'; DROP TABLE users; --"                               ‚îÇ
‚îÇ  –†–µ–∑—É–ª—å—Ç–∞—Ç: SELECT * FROM users WHERE email = $1                        ‚îÇ
‚îÇ             –ü–∞—Ä–∞–º–µ—Ç—Ä $1 = "'; DROP TABLE users; --" (–∫–∞–∫ —Å—Ç—Ä–æ–∫–∞)        ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  TypeORM —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∏–Ω—ä–µ–∫—Ü–∏—é!               ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ß–µ—Ä–µ–∑ curl

```bash
# ==================== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï HELMET ====================

# –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
curl -I http://localhost:3001/api/images

# –û–∂–∏–¥–∞–µ–º—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:
# X-Content-Type-Options: nosniff
# X-Frame-Options: SAMEORIGIN
# X-XSS-Protection: 0
# Content-Security-Policy: ...

# ==================== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï RATE LIMITING ====================

# –¢–µ—Å—Ç –æ–±—â–µ–≥–æ –ª–∏–º–∏—Ç–∞ (100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 15 –º–∏–Ω—É—Ç)
for i in {1..105}; do
  echo "Request $i:"
  curl -s -o /dev/null -w "%{http_code}\n" http://localhost:3001/api/images
done

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# Request 1-100: 200
# Request 101-105: 429

# –¢–µ—Å—Ç auth –ª–∏–º–∏—Ç–∞ (10 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ —á–∞—Å)
for i in {1..12}; do
  echo "Attempt $i:"
  curl -s -o /dev/null -w "%{http_code}\n" \
    -X POST http://localhost:3001/api/auth/login \
    -H "Content-Type: application/json" \
    -d '{"email":"test@test.com","password":"wrong"}'
done

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# Attempt 1-10: 401 (–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å)
# Attempt 11-12: 429 (–ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω)

# ==================== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï CORS ====================

# –ó–∞–ø—Ä–æ—Å —Å –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–≥–æ origin
curl -X GET http://localhost:3001/api/images \
  -H "Origin: http://malicious-site.com" \
  -v

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Access-Control-Allow-Origin –∑–∞–≥–æ–ª–æ–≤–∫–∞

# –ó–∞–ø—Ä–æ—Å —Å —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω–æ–≥–æ origin
curl -X GET http://localhost:3001/api/images \
  -H "Origin: http://localhost:3000" \
  -v

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: Access-Control-Allow-Origin: http://localhost:3000

# ==================== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï VALIDATION ====================

# –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π email
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"invalid-email","username":"test","password":"123456"}'

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": ["email must be an email"],
#   "error": "Bad Request"
# }

# –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –ø–æ–ª–µ (forbidNonWhitelisted)
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","username":"test","password":"123456","hack":"injection"}'

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": ["property hack should not exist"],
#   "error": "Bad Request"
# }

# ==================== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï EXCEPTION FILTER ====================

# –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ä–µ—Å—É—Ä—Å
curl -X GET http://localhost:3001/api/images/00000000-0000-0000-0000-000000000000

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 404 Not Found
# {
#   "statusCode": 404,
#   "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ",
#   "error": "Not Found",
#   "timestamp": "2024-01-01T00:00:00.000Z",
#   "path": "/api/images/00000000-0000-0000-0000-000000000000"
# }

# –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π UUID
curl -X GET http://localhost:3001/api/images/invalid-uuid

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 400 Bad Request
# {
#   "statusCode": 400,
#   "message": "Validation failed (uuid is expected)",
#   "error": "Bad Request"
# }
```

---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å JavaScript (Frontend)

```javascript
// ==================== –û–ë–†–ê–ë–û–¢–ö–ê RATE LIMIT –û–®–ò–ë–û–ö ====================

const fetchWithRateLimitHandling = async (url, options = {}) => {
  const response = await fetch(url, {
    ...options,
    credentials: 'include',
  });

  if (response.status === 429) {
    const data = await response.json();
    
    // –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è –¥–æ —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
    const retryAfter = response.headers.get('Retry-After');
    const rateLimitReset = response.headers.get('RateLimit-Reset');
    
    console.error('Rate limit exceeded:', data.message);
    console.log('Retry after:', retryAfter, 'seconds');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ
    showToast({
      type: 'error',
      message: data.message,
    });
    
    throw new Error('RATE_LIMIT_EXCEEDED');
  }

  return response;
};

// ==================== –û–ë–†–ê–ë–û–¢–ö–ê VALIDATION –û–®–ò–ë–û–ö ====================

const handleValidationErrors = (errors) => {
  // errors –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π –∏–ª–∏ –º–∞—Å—Å–∏–≤–æ–º
  const messages = Array.isArray(errors) ? errors : [errors];
  
  messages.forEach(message => {
    showToast({
      type: 'error',
      message,
    });
  });
};

const submitForm = async (data) => {
  try {
    const response = await fetch('/api/auth/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data),
    });

    if (!response.ok) {
      const error = await response.json();
      
      if (response.status === 400) {
        handleValidationErrors(error.message);
        return;
      }
      
      throw new Error(error.message);
    }

    return response.json();
  } catch (error) {
    console.error('Form submission error:', error);
  }
};

// ==================== –ü–†–û–í–ï–†–ö–ê CORS ====================

// –ï—Å–ª–∏ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –±—Ä–∞—É–∑–µ—Ä –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å
// –∏ –≤—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å:
// "Access to fetch at 'http://localhost:3001/api/...' from origin 
// 'http://localhost:3000' has been blocked by CORS policy"

const checkCorsConfiguration = async () => {
  try {
    const response = await fetch('http://localhost:3001/api/images', {
      credentials: 'include',
    });
    console.log('CORS is configured correctly');
    return true;
  } catch (error) {
    console.error('CORS error:', error);
    return false;
  }
};
```

---

## üìä HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ Rate Limiting

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ª–∏–º–∏—Ç–∞—Ö:

| –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----------|----------|--------|
| `RateLimit-Limit` | –ú–∞–∫—Å–∏–º—É–º –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–∫–Ω–µ | `100` |
| `RateLimit-Remaining` | –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤ | `95` |
| `RateLimit-Reset` | –í—Ä–µ–º—è —Å–±—Ä–æ—Å–∞ (Unix timestamp) | `1704067200` |
| `Retry-After` | –°–µ–∫—É–Ω–¥ –¥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ (–ø—Ä–∏ 429) | `900` |

```bash
# –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
HTTP/1.1 200 OK
RateLimit-Limit: 100
RateLimit-Remaining: 95
RateLimit-Reset: 1704067200
```

---

## ‚ö†Ô∏è –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –æ–± –æ—à–∏–±–∫–µ

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "statusCode": 400,
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ –º–∞—Å—Å–∏–≤ –æ—à–∏–±–æ–∫",
  "error": "Bad Request",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/endpoint"
}
```

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫

```json
// 400 Bad Request (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
{
  "statusCode": 400,
  "message": ["email must be an email", "password must be at least 6 characters"],
  "error": "Bad Request",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/auth/register"
}

// 401 Unauthorized
{
  "statusCode": 401,
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å",
  "error": "Unauthorized",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/auth/login"
}

// 404 Not Found
{
  "statusCode": 404,
  "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ",
  "error": "Not Found",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/images/uuid"
}

// 429 Too Many Requests
{
  "statusCode": 429,
  "message": "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",
  "error": "Too Many Requests",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/images"
}

// 500 Internal Server Error
{
  "statusCode": 500,
  "message": "Internal server error",
  "error": "Internal Server Error",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "path": "/api/endpoint"
}
```

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Frontend

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```typescript
// frontend/composables/useApi.ts

interface ApiError {
  statusCode: number;
  message: string | string[];
  error: string;
  timestamp: string;
  path: string;
}

export const useApi = () => {
  const toast = useToast();

  /**
   * –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
   */
  const handleApiError = (error: ApiError) => {
    switch (error.statusCode) {
      case 400:
        // –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        const messages = Array.isArray(error.message) 
          ? error.message 
          : [error.message];
        messages.forEach(msg => {
          toast.error(msg);
        });
        break;

      case 401:
        // –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
        toast.error('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
        navigateTo('/login');
        break;

      case 403:
        // –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω
        toast.error('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω');
        break;

      case 404:
        // –ù–µ –Ω–∞–π–¥–µ–Ω–æ
        toast.error(error.message as string);
        break;

      case 429:
        // Rate limit
        toast.error(error.message as string);
        break;

      default:
        // –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏
        toast.error('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
    }
  };

  /**
   * Fetch —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
   */
  const apiFetch = async <T>(
    url: string,
    options: RequestInit = {}
  ): Promise<T | null> => {
    try {
      const response = await fetch(url, {
        ...options,
        credentials: 'include',
        headers: {
          'Content-Type': 'application/json',
          ...options.headers,
        },
      });

      if (!response.ok) {
        const error: ApiError = await response.json();
        handleApiError(error);
        return null;
      }

      return response.json();
    } catch (error) {
      console.error('API fetch error:', error);
      toast.error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.');
      return null;
    }
  };

  return {
    apiFetch,
    handleApiError,
  };
};
```

### Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è Rate Limit

```typescript
// frontend/utils/retryFetch.ts

interface RetryOptions {
  maxRetries?: number;
  baseDelay?: number;
}

/**
 * Fetch —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º retry –ø—Ä–∏ rate limit
 */
export const retryFetch = async (
  url: string,
  options: RequestInit = {},
  retryOptions: RetryOptions = {}
): Promise<Response> => {
  const { maxRetries = 3, baseDelay = 1000 } = retryOptions;
  let lastError: Error | null = null;

  for (let attempt = 0; attempt <= maxRetries; attempt++) {
    try {
      const response = await fetch(url, options);

      if (response.status === 429) {
        // –ü–æ–ª—É—á–∞–µ–º –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        const retryAfter = response.headers.get('Retry-After');
        const waitTime = retryAfter 
          ? parseInt(retryAfter, 10) * 1000 
          : baseDelay * Math.pow(2, attempt);

        if (attempt < maxRetries) {
          console.log(`Rate limited. Retrying in ${waitTime}ms...`);
          await new Promise(resolve => setTimeout(resolve, waitTime));
          continue;
        }
      }

      return response;
    } catch (error) {
      lastError = error as Error;
      
      if (attempt < maxRetries) {
        const waitTime = baseDelay * Math.pow(2, attempt);
        await new Promise(resolve => setTimeout(resolve, waitTime));
      }
    }
  }

  throw lastError || new Error('Max retries exceeded');
};
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Helmet
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞–∫–µ—Ç `helmet`
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –≤ `main.ts`
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω CSP –¥–ª—è Swagger –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö

### Rate Limiting
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞–∫–µ—Ç `express-rate-limit`
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –æ–±—â–∏–π –ª–∏–º–∏—Ç (100/15–º–∏–Ω)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω auth –ª–∏–º–∏—Ç (10/—á–∞—Å)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω upload –ª–∏–º–∏—Ç (50/—á–∞—Å)
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ –ª–∏–º–∏—Ç–æ–≤

### CORS
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω `enableCors()` –≤ `main.ts`
- [ ] –£–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `origin`
- [ ] –í–∫–ª—é—á–µ–Ω—ã `credentials: true`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å frontend

### Validation Pipe
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π `ValidationPipe`
- [ ] –í–∫–ª—é—á—ë–Ω `whitelist: true`
- [ ] –í–∫–ª—é—á—ë–Ω `forbidNonWhitelisted: true`
- [ ] –í–∫–ª—é—á—ë–Ω `transform: true`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è DTO

### Exception Filter
- [ ] –°–æ–∑–¥–∞–Ω `HttpExceptionFilter`
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ
- [ ] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

### Logging Interceptor
- [ ] –°–æ–∑–¥–∞–Ω `LoggingInterceptor`
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ (dev mode)
- [ ] –õ–æ–≥–∏—Ä—É–µ—Ç –º–µ—Ç–æ–¥, URL, —Å—Ç–∞—Ç—É—Å, –≤—Ä–µ–º—è

### SQL Injection Protection
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã TypeORM
- [ ] –ù–µ—Ç raw SQL —Å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–µ–π —Å—Ç—Ä–æ–∫
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω –∫–æ–¥ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ü–∞–∫–µ—Ç | –í–µ—Ä—Å–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|--------|----------|
| `helmet` | ^7.x | HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| `express-rate-limit` | ^7.x | Rate limiting |
| `class-validator` | ^0.14.x | –í–∞–ª–∏–¥–∞—Ü–∏—è DTO |
| `class-transformer` | ^0.5.x | –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö |
| `cookie-parser` | ^1.4.x | –ü–∞—Ä—Å–∏–Ω–≥ cookies |

---

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# Rate Limiting
RATE_LIMIT_WINDOW=900000           # 15 –º–∏–Ω—É—Ç –≤ –º—Å
RATE_LIMIT_MAX=100                 # –û–±—â–∏–π –ª–∏–º–∏—Ç
RATE_LIMIT_AUTH_WINDOW=3600000     # 1 —á–∞—Å –≤ –º—Å
RATE_LIMIT_AUTH_MAX=10             # Auth –ª–∏–º–∏—Ç
RATE_LIMIT_UPLOAD_WINDOW=3600000   # 1 —á–∞—Å –≤ –º—Å
RATE_LIMIT_UPLOAD_MAX=50           # Upload –ª–∏–º–∏—Ç

# CORS
CORS_ORIGIN=http://localhost:3000  # –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–π origin
```

---

## üöÄ –ü–æ—Ä—è–¥–æ–∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ü–û–†–Ø–î–û–ö –í–ù–ï–î–†–ï–ù–ò–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  1. –û–±–Ω–æ–≤–∏—Ç—å configuration.ts                                           ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ rate limiting                                ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  2. –û–±–Ω–æ–≤–∏—Ç—å .env                                                       ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ rate limiting                               ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  3. –°–æ–∑–¥–∞—Ç—å logging.interceptor.ts                                      ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ src/common/interceptors/logging.interceptor.ts                  ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  4. –°–æ–∑–¥–∞—Ç—å interceptors/index.ts                                       ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ –≠–∫—Å–ø–æ—Ä—Ç LoggingInterceptor                                      ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  5. –û–±–Ω–æ–≤–∏—Ç—å http-exception.filter.ts                                   ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫                                     ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  6. –û–±–Ω–æ–≤–∏—Ç—å main.ts                                                    ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏                            ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ                                                        ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏                           ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### Production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–í production –æ–∫—Ä—É–∂–µ–Ω–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã** ‚Äî –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis** ‚Äî –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ rate limiting
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS** ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è production
4. **–£–∂–µ—Å—Ç–æ—á–∏—Ç—å CSP** ‚Äî —É–±—Ä–∞—Ç—å `unsafe-inline` –∏ `unsafe-eval`
5. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å 429 –æ—à–∏–±–∫–∏

### Redis –¥–ª—è Rate Limiting (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```typescript
// –î–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ rate limiting –≤ production
import RedisStore from 'rate-limit-redis';
import { createClient } from 'redis';

const redisClient = createClient({ url: process.env.REDIS_URL });
await redisClient.connect();

app.use(
  rateLimit({
    store: new RedisStore({
      sendCommand: (...args: string[]) => redisClient.sendCommand(args),
    }),
    windowMs: 15 * 60 * 1000,
    max: 100,
  }),
);
```

### Helmet –≤ Production

```typescript
// –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è production
app.use(
  helmet({
    contentSecurityPolicy: {
      directives: {
        defaultSrc: ["'self'"],
        styleSrc: ["'self'"],
        imgSrc: ["'self'", 'data:'],
        scriptSrc: ["'self'"],
        // –£–±–∏—Ä–∞–µ–º unsafe-inline –∏ unsafe-eval
      },
    },
    hsts: {
      maxAge: 31536000, // 1 –≥–æ–¥
      includeSubDomains: true,
      preload: true,
    },
  }),
);
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Helmet.js Documentation](https://helmetjs.github.io/)
- [Express Rate Limit](https://github.com/express-rate-limit/express-rate-limit)
- [NestJS Security](https://docs.nestjs.com/security/helmet)
- [OWASP Security Guidelines](https://owasp.org/www-project-web-security-testing-guide/)
- [class-validator](https://github.com/typestack/class-validator)

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

- **–≠—Ç–∞–ø 1**: –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- **–≠—Ç–∞–ø 3**: Auth (JWT, –∑–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤)
- **–≠—Ç–∞–ø 7**: Upload (–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤)
- **–≠—Ç–∞–ø 11**: Docker (production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
