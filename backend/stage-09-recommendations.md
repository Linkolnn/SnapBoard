# –≠—Ç–∞–ø 9: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (Recommendations)

> **–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
> 
> **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –≠—Ç–∞–ø 6 (Images) ‚úÖ, –≠—Ç–∞–ø 3 (Auth) ‚úÖ
> 
> **–°–µ—Ä–≤–µ—Ä:** http://localhost:3001/api
> 
> **Swagger:** http://localhost:3001/api/docs

---

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ç–µ–≥–æ–≤ –∏ —Å–ª–æ–≤ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –±–∞–ª–ª—ã –∑–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ø-N –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

---

## üìö –ì–ª–æ—Å—Å–∞—Ä–∏–π (–¥–ª—è frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

### üéØ Recommendations (–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

**Recommendations** ‚Äî —Å–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ. –ü–æ—Ö–æ–∂–µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é —Ç–µ–≥–æ–≤ –∏ —Å–ª–æ–≤ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è.

### üìä Score (–û—Ü–µ–Ω–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏)

**Score** ‚Äî —á–∏—Å–ª–æ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ:
- **+2 –±–∞–ª–ª–∞** –∑–∞ –∫–∞–∂–¥—ã–π —Å–æ–≤–ø–∞–¥–∞—é—â–∏–π —Ç–µ–≥
- **+1 –±–∞–ª–ª** –∑–∞ –∫–∞–∂–¥–æ–µ —Å–æ–≤–ø–∞–¥–∞—é—â–µ–µ —Å–ª–æ–≤–æ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è (>2 —Å–∏–º–≤–æ–ª–æ–≤)

### üè∑Ô∏è Matched Tags (–°–æ–≤–ø–∞–≤—à–∏–µ —Ç–µ–≥–∏)

**Matched Tags** ‚Äî –º–∞—Å—Å–∏–≤ —Ç–µ–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–ø–∞–ª–∏ –º–µ–∂–¥—É –∏—Å—Ö–æ–¥–Ω—ã–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.

### üì± –õ–æ–∫–∞–ª—å–Ω–∞—è vs Backend —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ù–∞ frontend —É–∂–µ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ `FullscreenModal.vue`. Backend API –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/src/modules/images/
‚îú‚îÄ‚îÄ images.module.ts              # –ú–æ–¥—É–ª—å (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
‚îú‚îÄ‚îÄ images.controller.ts          # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (–¥–æ–±–∞–≤–∏—Ç—å endpoint)
‚îú‚îÄ‚îÄ images.service.ts             # –°–µ—Ä–≤–∏—Å (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥)
‚îî‚îÄ‚îÄ dto/
    ‚îú‚îÄ‚îÄ index.ts                  # –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö DTO
    ‚îî‚îÄ‚îÄ recommendations.dto.ts    # DTO –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–Ω–æ–≤—ã–π)
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è –∫–∞–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ ImagesModule, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å.

---

## üìù API Endpoints

### GET /api/images/:id/recommendations

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

**Headers:** `Cookie: access_token=...` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Path –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| id | UUID | ID –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è |

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| limit | number | 12 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (max: 50) |

**Response (200):**
```json
{
  "items": [
    {
      "id": "uuid",
      "url": "/uploads/images/image.jpg",
      "title": "Similar Sunset",
      "description": "Another beautiful sunset",
      "tags": ["nature", "sunset", "sky"],
      "width": 1920,
      "height": 1080,
      "isFavorite": false,
      "favoritesCount": 15,
      "score": 5,
      "matchedTags": ["nature", "sunset"],
      "user": {
        "id": "uuid",
        "username": "johndoe",
        "avatar": "/uploads/avatars/avatar.jpg"
      },
      "createdAt": "2024-01-01T00:00:00.000Z"
    }
  ],
  "sourceImage": {
    "id": "uuid",
    "title": "Original Sunset",
    "tags": ["nature", "sunset", "ocean"]
  },
  "totalMatches": 25
}
```

**Errors:**
- `404` ‚Äî –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

---

## ‚öôÔ∏è –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è

### Scoring —Å–∏—Å—Ç–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         –ê–õ–ì–û–†–ò–¢–ú SCORING                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:                                                  ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                  ‚îÇ
‚îÇ  title: "Beautiful Ocean Sunset"                                        ‚îÇ
‚îÇ  tags: ["nature", "sunset", "ocean", "sky"]                             ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:                                                     ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                      ‚îÇ
‚îÇ  sourceTags = ["nature", "sunset", "ocean", "sky"]                      ‚îÇ
‚îÇ  titleWords = ["beautiful", "ocean", "sunset"]  (—Å–ª–æ–≤–∞ > 2 —Å–∏–º–≤–æ–ª–æ–≤)    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –ö–∞–Ω–¥–∏–¥–∞—Ç A:                                                            ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                            ‚îÇ
‚îÇ  title: "Mountain Sunset View"                                          ‚îÇ
‚îÇ  tags: ["nature", "sunset", "mountain"]                                 ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –†–∞—Å—á—ë—Ç score:                                                          ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                          ‚îÇ
‚îÇ  –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ç–µ–≥–∏: "nature" (+2), "sunset" (+2) = 4 –±–∞–ª–ª–∞               ‚îÇ
‚îÇ  –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞: "sunset" (+1) = 1 –±–∞–ª–ª                              ‚îÇ
‚îÇ  –ò–¢–û–ì–û: 5 –±–∞–ª–ª–æ–≤                                                        ‚îÇ
‚îÇ  matchedTags: ["nature", "sunset"]                                      ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –ö–∞–Ω–¥–∏–¥–∞—Ç B:                                                            ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                            ‚îÇ
‚îÇ  title: "City Night Lights"                                             ‚îÇ
‚îÇ  tags: ["city", "night", "lights"]                                      ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –†–∞—Å—á—ë—Ç score:                                                          ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                          ‚îÇ
‚îÇ  –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ç–µ–≥–∏: –Ω–µ—Ç = 0 –±–∞–ª–ª–æ–≤                                       ‚îÇ
‚îÇ  –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞: –Ω–µ—Ç = 0 –±–∞–ª–ª–æ–≤                                      ‚îÇ
‚îÇ  –ò–¢–û–ì–û: 0 –±–∞–ª–ª–æ–≤ (–Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç)                            ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∞–≤–∏–ª–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

1. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** ‚Äî –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∞–º–æ —Å–µ–±—è
2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score** ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å score = 0 –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è
3. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** ‚Äî –ø–æ —É–±—ã–≤–∞–Ω–∏—é score, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ ‚Äî –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ)
4. **–õ–∏–º–∏—Ç** ‚Äî –º–∞–∫—Å–∏–º—É–º 50 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

## üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### DTOs

#### dto/recommendations.dto.ts

```typescript
import { ApiProperty } from '@nestjs/swagger';
import { IsOptional, IsInt, Min, Max } from 'class-validator';
import { Type } from 'class-transformer';

/**
 * DTO –¥–ª—è query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
 */
export class RecommendationsQueryDto {
  @ApiProperty({
    example: 12,
    description: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (max: 50)',
    required: false,
  })
  @IsOptional()
  @Type(() => Number)
  @IsInt()
  @Min(1)
  @Max(50)
  limit?: number = 12;
}

/**
 * DTO –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
 */
export class RecommendationUserDto {
  @ApiProperty({ example: 'uuid' })
  id: string;

  @ApiProperty({ example: 'johndoe' })
  username: string;

  @ApiProperty({ example: '/uploads/avatars/avatar.jpg', nullable: true })
  avatar: string | null;
}

/**
 * DTO —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
export class RecommendedImageDto {
  @ApiProperty({ example: 'uuid' })
  id: string;

  @ApiProperty({ example: '/uploads/images/image.jpg' })
  url: string;

  @ApiProperty({ example: 'Similar Sunset', nullable: true })
  title: string | null;

  @ApiProperty({ example: 'Another beautiful sunset', nullable: true })
  description: string | null;

  @ApiProperty({ example: ['nature', 'sunset'], nullable: true })
  tags: string[] | null;

  @ApiProperty({ example: 1920 })
  width: number;

  @ApiProperty({ example: 1080 })
  height: number;

  @ApiProperty({ example: false })
  isFavorite: boolean;

  @ApiProperty({ example: 15 })
  favoritesCount: number;

  @ApiProperty({ example: 5, description: '–û—Ü–µ–Ω–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏' })
  score: number;

  @ApiProperty({ example: ['nature', 'sunset'], description: '–°–æ–≤–ø–∞–≤—à–∏–µ —Ç–µ–≥–∏' })
  matchedTags: string[];

  @ApiProperty({ type: RecommendationUserDto })
  user: RecommendationUserDto;

  @ApiProperty({ example: '2024-01-01T00:00:00.000Z' })
  createdAt: Date;
}

/**
 * DTO –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
 */
export class SourceImageDto {
  @ApiProperty({ example: 'uuid' })
  id: string;

  @ApiProperty({ example: 'Original Sunset', nullable: true })
  title: string | null;

  @ApiProperty({ example: ['nature', 'sunset', 'ocean'] })
  tags: string[];
}

/**
 * DTO –æ—Ç–≤–µ—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
 */
export class RecommendationsResponseDto {
  @ApiProperty({ type: [RecommendedImageDto] })
  items: RecommendedImageDto[];

  @ApiProperty({ type: SourceImageDto })
  sourceImage: SourceImageDto;

  @ApiProperty({ example: 25, description: '–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π' })
  totalMatches: number;
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å dto/index.ts

```typescript
export * from './image-query.dto';
export * from './update-image.dto';
export * from './image-response.dto';
export * from './recommendations.dto'; // –î–æ–±–∞–≤–∏—Ç—å
```

---

### images.service.ts (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥)

```typescript
/**
 * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
async getRecommendations(
  imageId: string,
  limit: number = 12,
  currentUserId?: string,
): Promise<{
  items: any[];
  sourceImage: { id: string; title: string | null; tags: string[] };
  totalMatches: number;
}> {
  // 1. –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  const sourceImage = await this.imagesRepository.findOne({
    where: { id: imageId },
  });

  if (!sourceImage) {
    throw new NotFoundException('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
  }

  const sourceTags = sourceImage.tags || [];
  const sourceTitle = (sourceImage.title || '').toLowerCase();
  const titleWords = sourceTitle
    .split(/\s+/)
    .filter((w) => w.length > 2);

  // –ï—Å–ª–∏ –Ω–µ—Ç —Ç–µ–≥–æ–≤ –∏ —Å–ª–æ–≤ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  if (sourceTags.length === 0 && titleWords.length === 0) {
    return {
      items: [],
      sourceImage: {
        id: sourceImage.id,
        title: sourceImage.title,
        tags: [],
      },
      totalMatches: 0,
    };
  }

  // 2. –°—Ç—Ä–æ–∏–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö
  const queryBuilder = this.imagesRepository
    .createQueryBuilder('image')
    .leftJoinAndSelect('image.user', 'user')
    .where('image.id != :imageId', { imageId });

  // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º –ò–õ–ò —Å–ª–æ–≤–∞–º –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
  const conditions: string[] = [];

  if (sourceTags.length > 0) {
    conditions.push('image.tags && :tags');
    queryBuilder.setParameter('tags', sourceTags);
  }

  if (titleWords.length > 0) {
    const wordConditions = titleWords.map((word, index) => {
      queryBuilder.setParameter(`word${index}`, `%${word}%`);
      return `LOWER(image.title) LIKE :word${index}`;
    });
    conditions.push(`(${wordConditions.join(' OR ')})`);
  }

  if (conditions.length > 0) {
    queryBuilder.andWhere(`(${conditions.join(' OR ')})`);
  }

  // 3. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  const candidates = await queryBuilder.getMany();

  // 4. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
  const scored = candidates.map((img) => {
    const imgTags = img.tags || [];
    const imgTitle = (img.title || '').toLowerCase();

    let score = 0;
    const matchedTags: string[] = [];

    // +2 –∑–∞ –∫–∞–∂–¥—ã–π —Å–æ–≤–ø–∞–¥–∞—é—â–∏–π —Ç–µ–≥
    sourceTags.forEach((tag) => {
      if (imgTags.includes(tag)) {
        score += 2;
        matchedTags.push(tag);
      }
    });

    // +1 –∑–∞ –∫–∞–∂–¥–æ–µ —Å–æ–≤–ø–∞–¥–∞—é—â–µ–µ —Å–ª–æ–≤–æ
    titleWords.forEach((word) => {
      if (imgTitle.includes(word)) {
        score += 1;
      }
    });

    return { image: img, score, matchedTags };
  });

  // 5. –§–∏–ª—å—Ç—Ä—É–µ–º –Ω—É–ª–µ–≤—ã–µ score –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º
  const filtered = scored.filter((item) => item.score > 0);

  const sorted = filtered
    .sort((a, b) => {
      if (b.score !== a.score) return b.score - a.score;
      return (
        new Date(b.image.createdAt).getTime() -
        new Date(a.image.createdAt).getTime()
      );
    })
    .slice(0, limit);

  // 6. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
  const items = await Promise.all(
    sorted.map(async ({ image, score, matchedTags }) => {
      const formatted = await this.formatImage(image, currentUserId);
      return {
        ...formatted,
        score,
        matchedTags,
      };
    }),
  );

  return {
    items,
    sourceImage: {
      id: sourceImage.id,
      title: sourceImage.title,
      tags: sourceImage.tags || [],
    },
    totalMatches: filtered.length,
  };
}
```

---

### images.controller.ts (–¥–æ–±–∞–≤–∏—Ç—å endpoint)

```typescript
import { RecommendationsQueryDto, RecommendationsResponseDto } from './dto';

// ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints ...

/**
 * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
@Get(':id/recommendations')
@Public() // –î–æ—Å—Ç—É–ø–Ω–æ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
@ApiOperation({ summary: '–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è' })
@ApiParam({ name: 'id', description: 'ID –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è' })
@ApiQuery({ name: 'limit', required: false, type: Number, description: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (max: 50)' })
@ApiResponse({ status: 200, description: '–°–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π', type: RecommendationsResponseDto })
@ApiResponse({ status: 404, description: '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ' })
async getRecommendations(
  @Param('id', ParseUUIDPipe) id: string,
  @Query() query: RecommendationsQueryDto,
  @CurrentUser('userId') userId?: string,
) {
  return this.imagesService.getRecommendations(id, query.limit, userId);
}
```

> **–í–∞–∂–Ω–æ:** Endpoint –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–º–µ—â—ë–Ω –ü–ï–†–ï–î `@Get(':id')`, —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –Ω–∏–º.

---

## üîß –ü–æ—Ä—è–¥–æ–∫ endpoints –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

```typescript
@Controller('images')
export class ImagesController {
  // 1. –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏
  @Get()
  async findAll() { ... }

  // 2. –ó–∞—Ç–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å –ø–æ–¥–ø—É—Ç—è–º–∏
  @Get(':id/recommendations')  // /api/images/:id/recommendations
  async getRecommendations() { ... }

  // 3. –í –∫–æ–Ω—Ü–µ –ø—Ä–æ—Å—Ç—ã–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
  @Get(':id')                   // /api/images/:id
  async findOne() { ... }

  @Put(':id')
  async update() { ... }

  @Delete(':id')
  async remove() { ... }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ Swagger UI

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3001/api/docs

### –ß–µ—Ä–µ–∑ curl

```bash
# ==================== –ü–û–õ–£–ß–ï–ù–ò–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô ====================

# –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 12 —à—Ç—É–∫)
curl -X GET "http://localhost:3001/api/images/{image-uuid}/recommendations"

# –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ª–∏–º–∏—Ç–∞
curl -X GET "http://localhost:3001/api/images/{image-uuid}/recommendations?limit=20"

# –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π (–¥–ª—è isFavorite)
curl -X GET "http://localhost:3001/api/images/{image-uuid}/recommendations?limit=12" \
  -b cookies.txt

# ==================== –ü–†–ò–ú–ï–†–´ –û–¢–í–ï–¢–û–í ====================

# –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200)
# {
#   "items": [
#     {
#       "id": "uuid-1",
#       "url": "/uploads/images/sunset.jpg",
#       "title": "Mountain Sunset",
#       "tags": ["nature", "sunset"],
#       "score": 5,
#       "matchedTags": ["nature", "sunset"],
#       "isFavorite": false,
#       "favoritesCount": 10,
#       ...
#     }
#   ],
#   "sourceImage": {
#     "id": "uuid-source",
#     "title": "Ocean Sunset",
#     "tags": ["nature", "sunset", "ocean"]
#   },
#   "totalMatches": 25
# }

# –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ (404)
# {
#   "statusCode": 404,
#   "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
# }

# –ù–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (200, –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)
# {
#   "items": [],
#   "sourceImage": { "id": "uuid", "title": "Unique Image", "tags": [] },
#   "totalMatches": 0
# }
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å JavaScript (Frontend)

```javascript
// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
const getRecommendations = async (imageId, limit = 12) => {
  const response = await fetch(
    `/api/images/${imageId}/recommendations?limit=${limit}`,
    { credentials: 'include' }
  );
  return response.json();
};

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const loadRecommendations = async () => {
  const { items, sourceImage, totalMatches } = await getRecommendations(currentImageId);
  
  console.log(`–ù–∞–π–¥–µ–Ω–æ ${totalMatches} –ø–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`);
  console.log(`–ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${sourceImage.title}`);
  console.log(`–¢–µ–≥–∏: ${sourceImage.tags.join(', ')}`);
  
  // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
  recommendations.value = items;
};

// –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –ª–æ–∫–∞–ª—å–Ω—ã–µ + API —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
const loadRecommendationsHybrid = async (image, allImages) => {
  // 1. –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
  recommendations.value = getLocalRecommendations(image, allImages);
  
  // 2. –ó–∞—Ç–µ–º –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ API (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
  try {
    const { items } = await getRecommendations(image.id);
    if (items.length > 0) {
      recommendations.value = items;
    }
  } catch (error) {
    // Fallback: –æ—Å—Ç–∞–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    console.warn('API recommendations failed, using local fallback');
  }
};

// –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è fallback
const getLocalRecommendations = (image, allImages) => {
  const currentTags = image.tags || [];
  const titleWords = (image.title || '').toLowerCase().split(/\s+/).filter(w => w.length > 2);
  
  return allImages
    .filter(img => img.id !== image.id)
    .map(img => {
      let score = 0;
      const matchedTags = [];
      
      currentTags.forEach(tag => {
        if (img.tags?.includes(tag)) {
          score += 2;
          matchedTags.push(tag);
        }
      });
      
      titleWords.forEach(word => {
        if (img.title?.toLowerCase().includes(word)) score += 1;
      });
      
      return { ...img, score, matchedTags };
    })
    .filter(img => img.score > 0)
    .sort((a, b) => b.score - a.score)
    .slice(0, 12);
};
```

---

## üîÑ –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ü–û–õ–£–ß–ï–ù–ò–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  Frontend                          Backend                              ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                         ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                              ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  GET /api/images/:id/recommendations ‚îÄ‚îÄ‚ñ∫ ImagesController               ‚îÇ
‚îÇ  ?limit=12                              ‚îÇ                               ‚îÇ
‚îÇ  Cookie: access_token (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)     ‚ñº                               ‚îÇ
‚îÇ                                         ImagesService.getRecommendations‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         1. –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚îú‚îÄ‚îÄ –ù–µ –Ω–∞–π–¥–µ–Ω–æ ‚îÄ‚îÄ‚ñ∫ 404 Not Found‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº –ù–∞–π–¥–µ–Ω–æ                       ‚îÇ
‚îÇ                                         2. –ò–∑–≤–ª–µ—á—å —Ç–µ–≥–∏ –∏ —Å–ª–æ–≤–∞         ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚îú‚îÄ‚îÄ –ù–µ—Ç —Ç–µ–≥–æ–≤ –∏ —Å–ª–æ–≤ ‚îÄ‚îÄ‚ñ∫ []     ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         3. –ù–∞–π—Ç–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤             ‚îÇ
‚îÇ                                         (tags && :tags OR title LIKE)   ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         4. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å score             ‚îÇ
‚îÇ                                         +2 –∑–∞ —Ç–µ–≥, +1 –∑–∞ —Å–ª–æ–≤–æ          ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         5. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å score = 0      ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         6. –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ score DESC    ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         7. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ limit          ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ                                         8. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç          ‚îÇ
‚îÇ                                         (–¥–æ–±–∞–≤–∏—Ç—å isFavorite, user)     ‚îÇ
‚îÇ                                         ‚îÇ                               ‚îÇ
‚îÇ                                         ‚ñº                               ‚îÇ
‚îÇ  ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  { items, sourceImage, total }   ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ê–õ–ì–û–†–ò–¢–ú SCORING (–¥–µ—Ç–∞–ª—å–Ω–æ)                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                         ‚îÇ
‚îÇ  –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:                                                  ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                  ‚îÇ
‚îÇ  id: "source-uuid"                                                      ‚îÇ
‚îÇ  title: "Beautiful Ocean Sunset Photography"                            ‚îÇ
‚îÇ  tags: ["nature", "sunset", "ocean", "photography"]                     ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ:                                                            ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                            ‚îÇ
‚îÇ  sourceTags = ["nature", "sunset", "ocean", "photography"]              ‚îÇ
‚îÇ  titleWords = ["beautiful", "ocean", "sunset", "photography"]           ‚îÇ
‚îÇ               (—Å–ª–æ–≤–∞ > 2 —Å–∏–º–≤–æ–ª–æ–≤)                                      ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ –ö–∞–Ω–¥–∏–¥–∞—Ç A                                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ title: "Mountain Sunset View"                                   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ tags: ["nature", "sunset", "mountain"]                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ç–µ–≥–∏:                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "nature" ‚úì (+2)                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "sunset" ‚úì (+2)                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "ocean" ‚úó                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "photography" ‚úó                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞ –≤ title:                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "beautiful" ‚úó                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "ocean" ‚úó                                                     ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "sunset" ‚úì (+1)                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "photography" ‚úó                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ò–¢–û–ì–û: 4 + 1 = 5 –±–∞–ª–ª–æ–≤                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ matchedTags: ["nature", "sunset"]                               ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ –ö–∞–Ω–¥–∏–¥–∞—Ç B                                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ title: "Ocean Waves"                                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ tags: ["ocean", "water", "waves"]                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ç–µ–≥–∏:                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "nature" ‚úó                                                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "sunset" ‚úó                                                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "ocean" ‚úì (+2)                                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "photography" ‚úó                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞ –≤ title:                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "beautiful" ‚úó                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "ocean" ‚úì (+1)                                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "sunset" ‚úó                                                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   "photography" ‚úó                                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ò–¢–û–ì–û: 2 + 1 = 3 –±–∞–ª–ª–∞                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ matchedTags: ["ocean"]                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ –ö–∞–Ω–¥–∏–¥–∞—Ç C                                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ title: "City Night Lights"                                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ tags: ["city", "night", "lights"]                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ç–µ–≥–∏: –Ω–µ—Ç                                           ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞: –Ω–µ—Ç                                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ –ò–¢–û–ì–û: 0 –±–∞–ª–ª–æ–≤ (–ù–ï –í–ö–õ–Æ–ß–ê–ï–¢–°–Ø –í –†–ï–ó–£–õ–¨–¢–ê–¢)                     ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îÇ  –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:                                                  ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                                  ‚îÇ
‚îÇ  1. –ö–∞–Ω–¥–∏–¥–∞—Ç A (score: 5)                                               ‚îÇ
‚îÇ  2. –ö–∞–Ω–¥–∏–¥–∞—Ç B (score: 3)                                               ‚îÇ
‚îÇ  (–ö–∞–Ω–¥–∏–¥–∞—Ç C –∏—Å–∫–ª—é—á—ë–Ω ‚Äî score: 0)                                       ‚îÇ
‚îÇ                                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Frontend

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–ù–∞ frontend —É–∂–µ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ `FullscreenModal.vue`. –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ backend API —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–ó–∞–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –Ω–∞ API –≤—ã–∑–æ–≤** ‚Äî –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–π –ë–î
2. **–û—Å—Ç–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –∫–∞–∫ fallback** ‚Äî –¥–ª—è offline-—Ä–µ–∂–∏–º–∞

### Composable –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

```typescript
// frontend/composables/useRecommendations.ts
export const useRecommendations = () => {
  const recommendations = ref<Image[]>([])
  const isLoading = ref(false)
  const sourceImage = ref<{ id: string; title: string; tags: string[] } | null>(null)
  const totalMatches = ref(0)

  /**
   * –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏–∑ API
   */
  const loadRecommendations = async (imageId: string, limit = 12) => {
    isLoading.value = true
    try {
      const { data } = await useFetch(`/api/images/${imageId}/recommendations`, {
        query: { limit }
      })
      
      if (data.value) {
        recommendations.value = data.value.items || []
        sourceImage.value = data.value.sourceImage
        totalMatches.value = data.value.totalMatches
      }
      
      return data.value
    } catch (error) {
      console.error('Failed to load recommendations:', error)
      return null
    } finally {
      isLoading.value = false
    }
  }

  /**
   * –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (fallback)
   */
  const getLocalRecommendations = (image: Image, allImages: Image[], limit = 12) => {
    const currentTags = image.tags || []
    const titleWords = (image.title || '')
      .toLowerCase()
      .split(/\s+/)
      .filter(w => w.length > 2)

    const scored = allImages
      .filter(img => img.id !== image.id)
      .map(img => {
        let score = 0
        const matchedTags: string[] = []

        currentTags.forEach(tag => {
          if (img.tags?.includes(tag)) {
            score += 2
            matchedTags.push(tag)
          }
        })

        titleWords.forEach(word => {
          if (img.title?.toLowerCase().includes(word)) {
            score += 1
          }
        })

        return { ...img, score, matchedTags }
      })
      .filter(item => item.score > 0)
      .sort((a, b) => b.score - a.score)
      .slice(0, limit)

    return scored
  }

  /**
   * –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: —Å–Ω–∞—á–∞–ª–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ, –ø–æ—Ç–æ–º API
   */
  const loadRecommendationsHybrid = async (
    image: Image,
    allImages: Image[],
    limit = 12
  ) => {
    // 1. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ
    recommendations.value = getLocalRecommendations(image, allImages, limit)

    // 2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ API
    const apiResult = await loadRecommendations(image.id, limit)
    
    if (apiResult?.items?.length) {
      recommendations.value = apiResult.items
    }
  }

  return {
    recommendations,
    isLoading,
    sourceImage,
    totalMatches,
    loadRecommendations,
    getLocalRecommendations,
    loadRecommendationsHybrid,
  }
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ FullscreenModal.vue

```vue
<!-- frontend/components/image/FullscreenModal.vue -->
<script setup lang="ts">
const { recommendations, isLoading, loadRecommendations } = useRecommendations()

// –ó–∞–º–µ–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –Ω–∞ API –≤—ã–∑–æ–≤
watch(() => props.image, async (newImage) => {
  if (newImage) {
    await loadRecommendations(newImage.id, 12)
  }
}, { immediate: true })
</script>

<template>
  <!-- –°–µ–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π -->
  <div class="recommendations-section">
    <h3>–ü–æ—Ö–æ–∂–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h3>
    
    <div v-if="isLoading" class="loading">
      –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π...
    </div>
    
    <div v-else-if="recommendations.length" class="recommendations-grid">
      <ImageCard
        v-for="rec in recommendations"
        :key="rec.id"
        :image="rec"
        @click="selectImage(rec)"
      />
    </div>
    
    <div v-else class="no-recommendations">
      –ü–æ—Ö–æ–∂–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    </div>
  </div>
</template>
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü–æ—Ä—è–¥–æ–∫ endpoints –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

```typescript
// –í–ê–ñ–ù–û: /:id/recommendations –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –î–û /:id
@Get(':id/recommendations')  // GET /api/images/:id/recommendations
async getRecommendations() { ... }

@Get(':id')                   // GET /api/images/:id
async findOne() { ... }
```

–ï—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫, "recommendations" –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ UUID –∏ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É.

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–ò–Ω–¥–µ–∫—Å—ã** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å GIN –∏–Ω–¥–µ–∫—Å –Ω–∞ –ø–æ–ª–µ `tags`:
   ```sql
   CREATE INDEX idx_images_tags ON images USING GIN(tags);
   ```

2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

3. **–õ–∏–º–∏—Ç** ‚Äî –º–∞–∫—Å–∏–º—É–º 50 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

### –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø

Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`@Public()`), –Ω–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –≤ –æ—Ç–≤–µ—Ç–µ –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `isFavorite`.

### –ü—É—Å—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ï—Å–ª–∏ —É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ—Ç —Ç–µ–≥–æ–≤ –∏ —Å–ª–æ–≤ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ (>2 —Å–∏–º–≤–æ–ª–æ–≤), –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –±–µ–∑ –æ—à–∏–±–∫–∏.

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [ ] DTO —Å–æ–∑–¥–∞–Ω (`recommendations.dto.ts`)
- [ ] –ú–µ—Ç–æ–¥ `getRecommendations` –¥–æ–±–∞–≤–ª–µ–Ω –≤ ImagesService
- [ ] Endpoint –¥–æ–±–∞–≤–ª–µ–Ω –≤ ImagesController
- [ ] –≠–∫—Å–ø–æ—Ä—Ç DTO –æ–±–Ω–æ–≤–ª—ë–Ω –≤ `dto/index.ts`
- [ ] –ü–æ—Ä—è–¥–æ–∫ endpoints –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
- [ ] Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl/Swagger
- [ ] Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìã –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö —ç—Ç–∞–ø–æ–≤

| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------------|-------------|--------|
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ImagesModule | ‚úÖ –≠—Ç–∞–ø 6 |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | AuthModule | ‚úÖ –≠—Ç–∞–ø 3 |
| –ò–∑–±—Ä–∞–Ω–Ω–æ–µ (–¥–ª—è isFavorite) | FavoritesModule | ‚úÖ –≠—Ç–∞–ø 8 |

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ endpoints

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:

| Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| GET /api/images/:id/recommendations | –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è |

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Backend API –Ω–∞–¥ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π

| –ê—Å–ø–µ–∫—Ç | –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è | Backend API |
|--------|------------------|-------------|
| –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º | –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | –í—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| –¢–æ—á–Ω–æ—Å—Ç—å | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ | –ü–æ–ª–Ω—ã–π scoring |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–µ—Ç | –í–æ–∑–º–æ–∂–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è | –ù–µ—Ç | –í–æ–∑–º–æ–∂–Ω–∞ (—É—á—ë—Ç –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ) |
| Offline | –†–∞–±–æ—Ç–∞–µ—Ç | –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî —Å–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–ª–∏–∫–∞, –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–ª—è—Ç—å –∏–∑ A
